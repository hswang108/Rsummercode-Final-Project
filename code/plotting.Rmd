---
title: "R Notebook"
output: html_notebook
---

```{r}
# install.packages("raster")
library(data.table)
library(dplyr)
library(tidyverse)
library(ggmap)
library(raster)
library(ggplot2)
library(maptools)
library(rgdal)
```


```{r}
Taiwan <- readOGR("/Users/penny/Documents/GitHub/Rsummercode-Final-Project/data/mapdata201805310314/", "COUNTY_MOI_1070516")
head(Taiwan)
```

```{r}
taiwan.plot <- fortify(Taiwan)
```

```{r}
Taipei_building[is.na(Taipei_building$Unit),]$Unit <- Taipei_building[is.na(Taipei_building$Unit),]$Total / Taipei_building[is.na(Taipei_building$Unit),]$Building

tpemap <- ggplot() +
    geom_polygon(data = taiwan.plot[taiwan.plot$id == 11,], 
                 aes(x = long, y = lat, group = group), 
                 colour = "black", 
                 fill = "white",
                 size = 0.25) +
    geom_point(data = Taipei_building[(Taipei_building$Unit < 100) & (Taipei_building$Unit >= 20),],
               aes(x = lon, y = lat, color = Unit),
               size = 0.001) +
    scale_color_gradient(low="yellow", high="red", limits = c(20,100)) +
    geom_point(data = Taipei_building[Taipei_building$Unit >= 100,],
               aes(x = lon, y = lat),
               colour = "red",
               size = 0.001) +
    geom_point(data = Taipei_building[Taipei_building$Unit < 20,],
               aes(x = lon, y = lat),
               colour = "yellow",
               size = 0.001) + 
    geom_point(data = MRT,
               aes(x = lon, y = lat),
               colour = "blue",
               size = 0.3) +
    coord_map() 
print(tpemap)

```

