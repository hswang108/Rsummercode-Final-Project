---
title: "R Notebook"
output: html_notebook
---

```{r}
# install.packages("geosphere")
library(geosphere)
library(data.table)
library(dplyr)
library(tidyverse)
```

```{r}
MRT <- read_csv("/Users/penny/Documents/GitHub/Rsummercode-Final-Project/code/MRT.csv")
Taipei_building <- readRDS("/Users/penny/Documents/GitHub/Rsummercode-Final-Project/code/Taipei_building")

mindist <- function(coordinate){
dist <- c()
for(i in 1:length(MRT)){
  dist <- c(dist, distm(coordinate, MRT[i,c(6,5)]))
}
mindistance <- min(dist)
station <- MRT$Station[which(dist == min(dist))]
df <- matrix(c(mindistance, station), nrow = 1)

return(df)
}

Taipei_building$distance <- c(NA)
Taipei_building$Station <- c(NA)

for(j in 1:2400){
  Taipei_building[j,c(21,22)] <- mindist(Taipei_building[j,c(19,20)])
}

saveRDS(Taipei_building, file = "Taipei_building")
```

